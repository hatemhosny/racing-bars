{"version":3,"file":"racing-bars.umd.js","sources":["../../src/lib/load-data.ts","../../src/lib/options/options.actions.ts","../../src/lib/options/options.models.ts","../../src/lib/utils.ts","../../src/lib/dates.ts","../../src/lib/options/options.reducer.ts","../../src/lib/data/data.actions.ts","../../src/lib/data/data.reducer.ts","../../src/lib/ticker/ticker.actions.ts","../../src/lib/ticker/ticker.reducer.ts","../../src/lib/ticker/ticker.ts","../../src/lib/store/actions.ts","../../src/lib/store/reducer.ts","../../src/lib/store/store.ts","../../src/lib/data-utils.ts","../../src/lib/renderer/calculate-dimensions.ts","../../src/lib/renderer/helpers.ts","../../src/lib/renderer/render-header.ts","../../src/lib/renderer/elements.ts","../../src/lib/renderer/buttons.ts","../../src/lib/renderer/controls.ts","../../src/lib/renderer/render-initial-view.ts","../../src/lib/renderer/render-frame.ts","../../src/lib/renderer/resize.ts","../../src/lib/renderer/create-renderer.ts","../../src/lib/renderer/renderer-subscriber.ts","../../src/lib/styles/generated-styles.ts","../../src/lib/styles/style-inject.ts","../../src/lib/events.ts","../../src/lib/race.ts","../../src/shared/index.ts"],"sourcesContent":["import * as d3 from './d3';\r\nimport { Data, WideData } from './data';\r\n\r\nexport function loadData(\r\n  URL: string,\r\n  type: 'json' | 'csv' | 'tsv' | 'xml' = 'json',\r\n): Promise<Data[]> | Promise<WideData[]> {\r\n  switch (type) {\r\n    case 'json':\r\n      return d3.json(URL) as Promise<Data[]> | Promise<WideData[]>;\r\n    case 'csv':\r\n      return (d3.csv(URL) as unknown) as Promise<Data[]> | Promise<WideData[]>;\r\n    case 'tsv':\r\n      return (d3.tsv(URL) as unknown) as Promise<Data[]> | Promise<WideData[]>;\r\n    case 'xml':\r\n      return (d3.xml(URL) as unknown) as Promise<Data[]> | Promise<WideData[]>;\r\n    default:\r\n      throw new Error(`Unsupported data type: ${type}`);\r\n  }\r\n}\r\n","import { Options, OptionsAction } from './options.models';\n\nexport const actionTypes = {\n  loadOptions: 'options/load',\n  changeOptions: 'options/change',\n};\n\nexport const loadOptions = (options: Partial<Options>): OptionsAction => ({\n  type: actionTypes.loadOptions,\n  payload: options,\n});\n\nexport const changeOptions = (options: Partial<Options>): OptionsAction => ({\n  type: actionTypes.changeOptions,\n  payload: options,\n});\n","import { Action } from '../store';\nimport { Data, WideData } from '../data';\n\nexport interface OptionsAction extends Action {\n  payload: Partial<Options>;\n}\n\nexport class Options {\n  public selector!: string;\n  public dataShape!: 'long' | 'wide';\n  public dataTransform!: null | TransformFn;\n  public fillDateGapsInterval!: null | 'year' | 'month' | 'day';\n  public fillDateGapsValue!: 'last' | 'interpolate';\n  public title!: string;\n  public subTitle!: string;\n  public dateCounter!: string | ParamFunction;\n  public startDate!: string;\n  public endDate!: string;\n  public loop!: boolean;\n  public caption!: string;\n  public labelsPosition!: 'inside' | 'outside';\n  public labelsWidth!: number;\n  public showIcons!: boolean;\n  public colorSeed!: string | number;\n  public showGroups!: boolean;\n  public tickDuration!: number;\n  public topN!: number;\n  public inputHeight!: string;\n  public inputWidth!: string;\n  public minHeight!: number;\n  public minWidth!: number;\n  public height!: string;\n  public width!: string;\n  public marginTop!: number;\n  public marginRight!: number;\n  public marginBottom!: number;\n  public marginLeft!: number;\n  public mouseControls!: boolean;\n  public keyboardControls!: boolean;\n  public controlButtons!: 'all' | 'play' | 'none';\n  public overlays!: 'all' | 'play' | 'repeat' | 'none';\n  public autorun!: boolean;\n  public injectStyles!: boolean;\n  public theme!: string;\n  public colorMap!: { [key: string]: string } | string[];\n  public fixedScale!: boolean;\n  public fixedOrder!: string[];\n  public highlightBars!: boolean;\n  public selectBars!: boolean;\n}\n\nexport type TransformFn = (data: Data[] | WideData[]) => Data[] | WideData[];\n\nexport type ParamFunction = (currentDate: string, dateSlice: Data[], allDates: string[]) => string;\n","import * as d3 from './d3';\n\nimport { Data } from './data';\nimport { Store } from './store';\nimport { formatDate } from './dates';\nimport { ParamFunction } from './options';\n\nexport function getColor(d: Data, store: Store) {\n  const { names, groups } = store.getState().data;\n  const { showGroups, colorSeed, colorMap } = store.getState().options;\n\n  if (d.color) {\n    return d.color;\n  }\n\n  const useGroup = Boolean(d.group) && showGroups && groups.length > 0;\n  let values = useGroup ? groups : names;\n  if (colorSeed) {\n    values = shuffle(values, toNumber(colorSeed));\n  }\n  const currentValue = (useGroup ? d.group : d.name) as string;\n  let index = values.indexOf(currentValue);\n\n  if (colorMap) {\n    if (Array.isArray(colorMap)) {\n      while (index > colorMap.length - 1) {\n        index = index - colorMap.length;\n      }\n      return colorMap[index];\n    } else {\n      if (colorMap[currentValue]) {\n        return colorMap[currentValue];\n      }\n    }\n  }\n\n  const negativeIfOdd = index % 2 === 0 ? 1 : -1;\n  const lumVariation = (random(currentValue) / 10) * negativeIfOdd;\n  const HueSpacing = 360 / (values.length + 1);\n  const hue = (values.indexOf(currentValue) + 1) * HueSpacing;\n  return d3.hsl(hue, 0.75, 0.75 + lumVariation);\n}\n\nexport function getIconID(d: Data) {\n  return 'icon-' + safeName(d.name);\n}\n\nexport function zeroPad(n: string, w: number) {\n  while (n.toString().length < w) {\n    n = '0' + n;\n  }\n  return n;\n}\n\nfunction toNumber(s: string | number) {\n  s = String(s);\n  let nums = '';\n  for (let i = 0; i < s.length; i++) {\n    nums += zeroPad(String(s.charCodeAt(i)), 3);\n  }\n  return +nums;\n}\n\nexport function random(InputSeed: string | number) {\n  const seed = toNumber(InputSeed);\n  const x = Math.sin(seed) * 10000;\n  return x - Math.floor(x);\n}\n\nexport function shuffle(arr: string[], seed: number) {\n  const array = [...arr];\n  let m = array.length;\n  let t: string;\n  let i: number;\n\n  while (m) {\n    i = Math.floor(random(seed) * m--);\n    t = array[m];\n    array[m] = array[i];\n    array[i] = t;\n    ++seed;\n  }\n\n  return array;\n}\n\nexport function generateId(prefix = 'racingbars', n = 8) {\n  const rnd = Array(3)\n    .fill(null)\n    .map(() => Math.random().toString(36).substr(2))\n    .join('');\n  return prefix + rnd.slice(-n);\n}\n\nexport function getHeight(element: HTMLElement, minHeight: number, height?: string) {\n  let newHeight: number;\n  if (!height) {\n    newHeight = element.getBoundingClientRect().height;\n  } else if (String(height).startsWith('window')) {\n    const scale = +height.split('*')[1] || 1;\n    newHeight = window.innerHeight * scale;\n  } else {\n    newHeight = +height;\n  }\n  return newHeight > minHeight ? newHeight : minHeight;\n}\n\nexport function getWidth(element: HTMLElement, minWidth: number, width?: string) {\n  let newWidth: number;\n  if (!width) {\n    newWidth = element.getBoundingClientRect().width;\n  } else if (String(width).startsWith('window')) {\n    const scale = +width.split('*')[1] || 1;\n    newWidth = window.innerWidth * scale;\n  } else {\n    newWidth = +width;\n  }\n  return newWidth > minWidth ? newWidth : minWidth;\n}\n\nexport function getElement(root: HTMLElement, className: string) {\n  // TODO: fix Cannot read property 'querySelector' of null\n  return root.querySelector('.' + className) as HTMLElement;\n}\n\nexport function showElement(root: HTMLElement, className: string, useVisibility = false) {\n  const element = getElement(root, className);\n  if (element) {\n    if (useVisibility) {\n      element.style.visibility = 'unset';\n    } else {\n      element.style.display = 'flex';\n    }\n  }\n}\n\nexport function hideElement(root: HTMLElement, className: string, useVisibility = false) {\n  const element = getElement(root, className);\n  if (element) {\n    if (useVisibility) {\n      element.style.visibility = 'hidden';\n    } else {\n      element.style.display = 'none';\n    }\n  }\n}\n\nexport function removeElement(root: HTMLElement, className: string) {\n  const element = getElement(root, className);\n  if (element) {\n    element.remove();\n  }\n}\n\nexport function getText(\n  param: string | ParamFunction,\n  currentDate: string,\n  dateSlice: Data[],\n  dates: string[],\n  isDate = false,\n): string {\n  if (typeof param === 'function') {\n    return param(currentDate, dateSlice, dates);\n  }\n  if (isDate) {\n    return formatDate(currentDate, param);\n  }\n  return param;\n}\n\nexport function safeName(name: string) {\n  // replace non-alphanumeric with underscore\n  return name.replace(/[\\W]+/g, '_');\n}\n\nexport function toggleClass(root: HTMLElement, selector: string, className: string) {\n  d3.select(root)\n    .select(selector)\n    .classed(className, function () {\n      return !d3.select(this).classed(className);\n    });\n}\n\nfunction debounce(func: any, wait: number, immediate = false) {\n  let timeout: any;\n  return function (_clicks: any, _Fn: (clicks: number) => void) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const context = this;\n    const args = arguments;\n    const later = function () {\n      timeout = null;\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n}\n\nexport const getClicks = debounce(function (event: any, Fn: (event: any) => void) {\n  Fn(event);\n}, 250);\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport const pipe = (...fns: Function[]) => fns.reduce((f, g) => (...args: any) => g(f(...args)));\n","import * as d3 from './d3';\r\nimport { Data } from './data';\r\nimport { zeroPad } from './utils';\r\n\r\nexport const getDates = (data: Data[]) => Array.from(new Set(data.map((d) => d.date))).sort();\r\n\r\nexport function getDateString(inputDate: string | Date) {\r\n  const date = new Date(inputDate);\r\n  if (isNaN(+date)) {\r\n    throw new Error(`\"${inputDate}\" is not a valid date`);\r\n  }\r\n\r\n  const year = date.getFullYear().toString();\r\n  const month = zeroPad((1 + date.getMonth()).toString(), 2);\r\n  const day = zeroPad(date.getDate().toString(), 2);\r\n\r\n  return `${year}-${month}-${day}`;\r\n}\r\n\r\nexport function formatDate(dateStr: string, format = 'YYYY-MM-DD') {\r\n  const year = dateStr.slice(0, 4);\r\n  const month = dateStr.slice(5, 7);\r\n  const day = dateStr.slice(8, 10);\r\n  const date = new Date(dateStr);\r\n  const weekDayIndex = String(date.getDay());\r\n  const monthNames: { [key: string]: string } = {\r\n    '01': 'Jan',\r\n    '02': 'Feb',\r\n    '03': 'Mar',\r\n    '04': 'Apr',\r\n    '05': 'May',\r\n    '06': 'Jun',\r\n    '07': 'Jul',\r\n    '08': 'Aug',\r\n    '09': 'Sep',\r\n    '10': 'Oct',\r\n    '11': 'Nov',\r\n    '12': 'Dec',\r\n  };\r\n\r\n  const weekDays: { [key: string]: string } = {\r\n    '0': 'Sun',\r\n    '1': 'Mon',\r\n    '2': 'Tue',\r\n    '3': 'Wed',\r\n    '4': 'Thu',\r\n    '5': 'Fri',\r\n    '6': 'Sat',\r\n  };\r\n\r\n  return format\r\n    .replace('MMM', monthNames[month])\r\n    .replace('DDD', weekDays[weekDayIndex])\r\n    .replace('YYYY', year)\r\n    .replace('MM', month)\r\n    .replace('DD', day);\r\n}\r\n\r\nexport function getDateRange(date1: Date, date2: Date, interval: 'year' | 'month' | 'day') {\r\n  const range = [date1, ...d3.timeDay.range(date1, date2)];\r\n\r\n  const daysInMonth = (date: Date) =>\r\n    new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();\r\n\r\n  const sameDay = date1.getDate() === date2.getDate();\r\n  const sameMonth = date1.getMonth() === date2.getMonth();\r\n\r\n  const numberOfMonths = d3.timeMonth.count(date1, date2);\r\n  const numberOfYears = d3.timeYear.count(date1, date2);\r\n\r\n  let outputRange: Date[] = [];\r\n\r\n  if (interval === 'year') {\r\n    if (sameMonth && sameDay) {\r\n      outputRange = range.filter((date) => {\r\n        if (date.getMonth() === date1.getMonth()) {\r\n          if (date.getDate() === date1.getDate()) return true;\r\n          if (date1.getDate() > daysInMonth(date)) {\r\n            return date.getDate() === daysInMonth(date);\r\n          }\r\n        }\r\n        return false;\r\n      });\r\n    } else {\r\n      outputRange = range.filter(\r\n        (date) => range.indexOf(date) % Math.round(range.length / numberOfYears) === 0,\r\n      );\r\n    }\r\n  } else if (interval === 'month') {\r\n    if (sameDay) {\r\n      outputRange = range.filter((date) => {\r\n        if (date.getDate() === date1.getDate()) return true;\r\n        if (date1.getDate() > daysInMonth(date)) {\r\n          return date.getDate() === daysInMonth(date);\r\n        }\r\n        return false;\r\n      });\r\n    } else {\r\n      outputRange = range.filter(\r\n        (date) => range.indexOf(date) % Math.round(range.length / numberOfMonths) === 0,\r\n      );\r\n    }\r\n  } else if (interval === 'day') {\r\n    outputRange = range;\r\n  }\r\n\r\n  if (outputRange.length === 0) {\r\n    outputRange = [date1, date2];\r\n  }\r\n  if (getDateString(date1) !== getDateString(outputRange[0])) {\r\n    outputRange = [date1, ...outputRange];\r\n  }\r\n  if (getDateString(date2) !== getDateString(outputRange[outputRange.length - 1])) {\r\n    outputRange = [...outputRange, date2];\r\n  }\r\n\r\n  return outputRange;\r\n}\r\n\r\nexport function getNextDate(dates: string[], currentDate: string) {\r\n  const currentIndex = dates.indexOf(currentDate);\r\n  if (currentIndex === -1) return dates[0];\r\n  const lastIndex = dates.length - 1;\r\n  return currentIndex === lastIndex ? dates[0] : dates[currentIndex + 1];\r\n}\r\n","import { getDateString } from '../dates';\nimport { Reducer } from '../store';\nimport { Options, OptionsAction } from './options.models';\nimport { actionTypes } from './options.actions';\n\nexport const defaultOptions: Options = {\n  selector: '#race',\n  dataShape: 'long',\n  dataTransform: null,\n  fillDateGapsInterval: null,\n  fillDateGapsValue: 'interpolate',\n  startDate: '',\n  endDate: '',\n  colorSeed: '',\n  showGroups: false,\n  tickDuration: 500,\n  topN: 10,\n  mouseControls: false,\n  keyboardControls: false,\n  autorun: true,\n  loop: false,\n  injectStyles: true,\n  title: '',\n  subTitle: '',\n  caption: '',\n  dateCounter: 'MM/YYYY',\n  labelsPosition: 'inside',\n  labelsWidth: 150,\n  showIcons: false,\n  controlButtons: 'all',\n  overlays: 'none',\n  inputHeight: '',\n  inputWidth: '',\n  minHeight: 300,\n  minWidth: 500,\n  height: '',\n  width: '',\n  marginTop: 0,\n  marginRight: 20,\n  marginBottom: 5,\n  marginLeft: 0,\n  theme: 'light',\n  colorMap: {},\n  fixedScale: false,\n  fixedOrder: [],\n  highlightBars: false,\n  selectBars: false,\n};\n\nexport const optionsReducer: Reducer<Options, OptionsAction> = (state = defaultOptions, action) => {\n  switch (action.type) {\n    case actionTypes.loadOptions:\n    case actionTypes.changeOptions: {\n      const excludedKeys = ['inputHeight', 'inputWidth', 'minHeight', 'minWidth'];\n      const options: Partial<Options> = {};\n\n      // remove null, undefined and excluded keys\n      (Object.keys(action.payload) as Array<keyof Options>).forEach((key) => {\n        if (!excludedKeys.includes(key)) {\n          (options[key] as any) = action.payload[key] ?? state[key];\n        }\n      });\n\n      const startDate = options.startDate ? getDateString(options.startDate) : state.startDate;\n      const endDate = options.endDate ? getDateString(options.endDate) : state.startDate;\n\n      const inputHeight = options.height || state.inputHeight;\n      const inputWidth = options.width || state.inputWidth;\n\n      const fixedOrder = Array.isArray(options.fixedOrder)\n        ? [...options.fixedOrder]\n        : state.fixedOrder;\n\n      const colorMap = Array.isArray(options.colorMap)\n        ? [...options.colorMap].map(String)\n        : typeof options.colorMap === 'object'\n        ? { ...options.colorMap }\n        : state.colorMap;\n\n      const topN = fixedOrder.length || Number(options.topN) || state.topN;\n\n      const tickDuration = Number(options.tickDuration) || state.tickDuration;\n      const labelsWidth = Number(options.labelsWidth) || state.labelsWidth;\n      const marginTop = Number(options.marginTop) || state.marginTop;\n      const marginRight = Number(options.marginRight) || state.marginRight;\n      const marginBottom = Number(options.marginBottom) || state.marginBottom;\n      const marginLeft = Number(options.marginLeft) || state.marginLeft;\n\n      return {\n        ...state,\n        ...options,\n        startDate,\n        endDate,\n        inputHeight,\n        inputWidth,\n        fixedOrder,\n        colorMap,\n        topN,\n        tickDuration,\n        labelsWidth,\n        marginTop,\n        marginRight,\n        marginBottom,\n        marginLeft,\n      };\n    }\n\n    default:\n      return state;\n  }\n};\n","import { DataAction, DataCollections, Data, DateSlice } from './data.models';\n\nexport const actionTypes = {\n  dataLoaded: 'data/loaded',\n  addFilter: 'data/addFilter',\n  removeFilter: 'data/removeFilter',\n  toggleFilter: 'data/toggleFilter',\n  resetFilters: 'data/resetFilters',\n  allExceptFilter: 'data/allExceptFilter',\n  addSelection: 'data/addSelection',\n  removeSelection: 'data/removeSelection',\n  toggleSelection: 'data/toggleSelection',\n  resetSelections: 'data/resetSelections',\n  addDateSlice: 'data/addDateSlice',\n  clearDateSlices: 'data/clearDateSlices',\n};\n\nexport const dataLoaded = (dataCollections: DataCollections): DataAction => ({\n  type: actionTypes.dataLoaded,\n  payload: dataCollections,\n});\n\nexport const addFilter = (group: string): DataAction => ({\n  type: actionTypes.addFilter,\n  payload: group,\n});\n\nexport const removeFilter = (group: string): DataAction => ({\n  type: actionTypes.removeFilter,\n  payload: group,\n});\n\nexport const toggleFilter = (group: string): DataAction => ({\n  type: actionTypes.toggleFilter,\n  payload: group,\n});\n\nexport const resetFilters = (): DataAction => ({\n  type: actionTypes.resetFilters,\n});\n\nexport const allExceptFilter = (group: string): DataAction => ({\n  type: actionTypes.allExceptFilter,\n  payload: group,\n});\n\nexport const addSelection = (selection: string): DataAction => ({\n  type: actionTypes.addSelection,\n  payload: selection,\n});\n\nexport const removeSelection = (selection: string): DataAction => ({\n  type: actionTypes.removeSelection,\n  payload: selection,\n});\n\nexport const toggleSelection = (selection: string): DataAction => ({\n  type: actionTypes.toggleSelection,\n  payload: selection,\n});\n\nexport const resetSelections = (): DataAction => ({\n  type: actionTypes.resetSelections,\n});\n\nexport const addDateSlice = (date: string, dateSlice: Data[]): DataAction => {\n  const payload: DateSlice = {};\n  payload[date] = dateSlice;\n  return {\n    type: actionTypes.addDateSlice,\n    payload,\n    triggerRender: false,\n  };\n};\n\nexport const clearDateSlices = (): DataAction => ({\n  type: actionTypes.clearDateSlices,\n});\n","import { Reducer } from '../store';\nimport { actionTypes } from './data.actions';\nimport { DataState, DataAction, DataCollections, DateSlice } from './data.models';\n\nconst initialState: DataState = {\n  names: [],\n  groups: [],\n  groupFilter: [],\n  selected: [],\n  dateSlices: {},\n};\n\nexport const dataReducer: Reducer<DataState, DataAction> = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.dataLoaded:\n      return {\n        ...state,\n        names: [...(action.payload as DataCollections).names],\n        groups: [...(action.payload as DataCollections).groups],\n      };\n\n    case actionTypes.addFilter:\n      return {\n        ...state,\n        groupFilter: addToArray(state.groupFilter, action.payload as string),\n      };\n\n    case actionTypes.removeFilter:\n      return {\n        ...state,\n        groupFilter: removeFromArray(state.groupFilter, action.payload as string),\n      };\n\n    case actionTypes.toggleFilter:\n      return {\n        ...state,\n        groupFilter: toggleItem(state.groupFilter, action.payload as string),\n      };\n\n    case actionTypes.resetFilters:\n      return {\n        ...state,\n        groupFilter: [],\n      };\n\n    case actionTypes.allExceptFilter:\n      return {\n        ...state,\n        groupFilter: removeFromArray(state.groups, action.payload as string),\n      };\n\n    case actionTypes.addSelection:\n      return {\n        ...state,\n        selected: addToArray(state.selected, action.payload as string),\n      };\n\n    case actionTypes.removeSelection:\n      return {\n        ...state,\n        selected: removeFromArray(state.selected, action.payload as string),\n      };\n\n    case actionTypes.toggleSelection:\n      return {\n        ...state,\n        selected: toggleItem(state.selected, action.payload as string),\n      };\n\n    case actionTypes.resetSelections:\n      return {\n        ...state,\n        selected: [],\n      };\n\n    case actionTypes.addDateSlice:\n      return {\n        ...state,\n        dateSlices: {\n          ...state.dateSlices,\n          ...(action.payload as DateSlice),\n        },\n      };\n\n    case actionTypes.clearDateSlices:\n      return {\n        ...state,\n        dateSlices: {},\n      };\n\n    default:\n      return state;\n  }\n};\n\nfunction addToArray(array: string[], item: string) {\n  const arr = [...array];\n  if (!arr.includes(item)) {\n    arr.push(item);\n  }\n  return arr;\n}\n\nfunction removeFromArray(array: string[], item: string) {\n  return array.filter((x) => x !== item);\n}\n\nfunction toggleItem(array: string[], item: string) {\n  return array.includes(item) ? removeFromArray(array, item) : addToArray(array, item);\n}\n","import { TickerAction } from './ticker.models';\n\nexport const actionTypes = {\n  initialize: 'ticker/initialize',\n  changeDates: 'ticker/changeDates',\n  updateDate: 'ticker/updateDate',\n  setRunning: 'ticker/setRunning',\n  setFirst: 'ticker/setFirst',\n  setLast: 'ticker/setLast',\n  inc: 'ticker/inc',\n  dec: 'ticker/dec',\n};\n\nexport const initialize = (dates: string[]): TickerAction => ({\n  type: actionTypes.initialize,\n  payload: dates,\n});\n\nexport const changeDates = (dates: string[]): TickerAction => ({\n  type: actionTypes.changeDates,\n  payload: dates,\n});\n\nexport const updateDate = (currentDate: string): TickerAction => ({\n  type: actionTypes.updateDate,\n  payload: currentDate,\n});\n\nexport const setRunning = (running: boolean): TickerAction => ({\n  type: actionTypes.setRunning,\n  payload: running,\n});\n\nexport const setFirst = (): TickerAction => ({\n  type: actionTypes.setFirst,\n});\n\nexport const setLast = (): TickerAction => ({\n  type: actionTypes.setLast,\n});\n\nexport const inc = (value = 1): TickerAction => ({\n  type: actionTypes.inc,\n  payload: value,\n});\n\nexport const dec = (value = 1): TickerAction => ({\n  type: actionTypes.dec,\n  payload: value,\n});\n","import { Reducer } from '../store';\nimport { TickerState, TickerAction } from './ticker.models';\nimport { actionTypes } from './ticker.actions';\n\nconst initialState: TickerState = {\n  isRunning: false,\n  currentDate: '',\n  isFirstDate: true,\n  isLastDate: false,\n  dates: [],\n};\n\nexport const tickerReducer: Reducer<TickerState, TickerAction> = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.initialize: {\n      const dates = action.payload as string[];\n      return {\n        ...state,\n        isRunning: false,\n        currentDate: dates[0],\n        isFirstDate: true,\n        isLastDate: false,\n        dates,\n      };\n    }\n\n    case actionTypes.changeDates: {\n      const dates = action.payload as string[];\n      const currentDate =\n        dates.indexOf(state.currentDate) !== -1\n          ? state.currentDate\n          : state.currentDate < dates[0]\n          ? dates[0]\n          : state.currentDate > dates[dates.length - 1]\n          ? dates[dates.length - 1]\n          : dates[[...dates, state.currentDate].sort().indexOf(state.currentDate)];\n      return {\n        ...state,\n        currentDate,\n        isFirstDate: currentDate === dates[0],\n        isLastDate: currentDate === dates[state.dates.length - 1],\n        dates,\n      };\n    }\n\n    case actionTypes.updateDate: {\n      const currentDate = action.payload as string;\n      if (state.dates.indexOf(currentDate) === -1) {\n        return { ...state };\n      }\n      return {\n        ...state,\n        currentDate,\n        isFirstDate: currentDate === state.dates[0],\n        isLastDate: currentDate === state.dates[state.dates.length - 1],\n      };\n    }\n\n    case actionTypes.setRunning: {\n      return {\n        ...state,\n        isRunning: action.payload as boolean,\n      };\n    }\n\n    case actionTypes.setFirst: {\n      return {\n        ...state,\n        currentDate: state.dates[0],\n        isFirstDate: true,\n        isLastDate: false,\n      };\n    }\n\n    case actionTypes.setLast: {\n      return {\n        ...state,\n        currentDate: state.dates[state.dates.length - 1],\n        isFirstDate: false,\n        isLastDate: true,\n      };\n    }\n\n    case actionTypes.inc: {\n      const currentIndex = state.dates.indexOf(state.currentDate);\n      const lastIndex = state.dates.length - 1;\n      const incValue = action.payload as number;\n      const newDate =\n        currentIndex + incValue > lastIndex\n          ? state.dates[lastIndex]\n          : state.dates[currentIndex + incValue];\n      return {\n        ...state,\n        currentDate: newDate,\n        isFirstDate: newDate === state.dates[0],\n        isLastDate: newDate === state.dates[lastIndex],\n      };\n    }\n\n    case actionTypes.dec: {\n      const currentIndex = state.dates.indexOf(state.currentDate);\n      const decValue = action.payload as number;\n      const newDate =\n        currentIndex - decValue < 0 ? state.dates[0] : state.dates[currentIndex - decValue];\n      return {\n        ...state,\n        currentDate: newDate,\n        isFirstDate: newDate === state.dates[0],\n        isLastDate: newDate === state.dates[state.dates.length - 1],\n      };\n    }\n\n    default:\n      return state;\n  }\n};\n","import * as d3 from '../d3';\nimport { actions, Store } from '../store';\nimport { Ticker } from './ticker.models';\n\nexport function createTicker(store: Store): Ticker {\n  let ticker: d3.Timer;\n\n  function start() {\n    let justStarted = true;\n    ticker = d3.interval(showRace, store.getState().options.tickDuration);\n    store.dispatch(actions.ticker.setRunning(true));\n\n    function showRace(_: number) {\n      if (!store.getState().ticker.isLastDate) {\n        store.dispatch(actions.ticker.inc());\n      } else {\n        if (store.getState().options.loop || justStarted) {\n          loop();\n        } else {\n          stop();\n        }\n      }\n      justStarted = false;\n    }\n  }\n\n  function stop() {\n    if (ticker) {\n      ticker.stop();\n    }\n    store.dispatch(actions.ticker.setRunning(false));\n  }\n\n  function skipBack() {\n    stop();\n    store.dispatch(actions.ticker.setFirst());\n  }\n\n  function loop() {\n    store.dispatch(actions.ticker.setFirst());\n  }\n\n  function skipForward() {\n    stop();\n    store.dispatch(actions.ticker.setLast());\n    store.dispatch(actions.ticker.setLast()); // workaround to avoid showing lastValue\n  }\n\n  function toggle() {\n    if (store.getState().ticker.isLastDate) {\n      skipBack();\n      start();\n    } else if (store.getState().ticker.isRunning) {\n      stop();\n    } else {\n      start();\n    }\n  }\n\n  function goToDate(date: string) {\n    store.dispatch(actions.ticker.updateDate(date));\n  }\n\n  return {\n    start,\n    stop,\n    skipBack,\n    loop,\n    skipForward,\n    toggle,\n    goToDate,\n  };\n}\n","import * as data from '../data';\r\nimport * as options from '../options';\r\nimport * as ticker from '../ticker';\r\n\r\nexport const actions = {\r\n  data,\r\n  options,\r\n  ticker,\r\n};\r\n","import { optionsReducer, OptionsAction } from '../options';\nimport { tickerReducer, TickerAction } from '../ticker';\nimport { dataReducer, DataAction } from '../data';\nimport { Action, State, Reducer } from './models';\n\nexport const rootReducer: Reducer<State, Action> = (state, action) => ({\n  data: dataReducer(state.data, action as DataAction),\n  options: optionsReducer(state.options, action as OptionsAction),\n  ticker: tickerReducer(state.ticker, action as TickerAction),\n  triggerRender: action.triggerRender ?? true,\n});\n","import { Action, Reducer, State, Subscriber, Store } from './models';\nimport { rootReducer } from './reducer';\n\nexport function createStore(\n  reducer: Reducer<State, Action> = rootReducer,\n  preloadedState?: State,\n): Store {\n  let state = {} as State;\n\n  if (preloadedState) {\n    state = preloadedState;\n  }\n\n  function dispatch(action: Action) {\n    state = reducer(state, action);\n    notifySubscribers();\n    return action;\n  }\n\n  function getState() {\n    return state;\n  }\n\n  const subscribers: Subscriber[] = [];\n\n  function subscribe(fn: Subscriber) {\n    subscribers.push(fn);\n    const index = subscribers.length - 1;\n\n    return {\n      unsubscribe: () => {\n        subscribers.splice(index, 1);\n      },\n    };\n  }\n\n  function notifySubscribers() {\n    subscribers.forEach((fn: Subscriber) => {\n      fn();\n    });\n  }\n\n  function unsubscribeAll() {\n    subscribers.length = 0;\n  }\n\n  return {\n    getState,\n    dispatch,\n    subscribe,\n    unsubscribeAll,\n  };\n}\n","import * as d3 from './d3';\n\nimport { getDateString, getDates, getDateRange, getNextDate } from './dates';\nimport { Data, WideData } from './data';\nimport { actions, Store } from './store';\nimport { Options, TransformFn } from './options';\nimport { pipe } from './utils';\n\nexport function prepareData(\n  data: Data[] | WideData[],\n  store: Store,\n  changingOptions = false,\n): Data[] {\n  const options = store.getState().options;\n  return pipe(\n    customDataTransform(options.dataTransform),\n    filterByDate(options.startDate, options.endDate),\n    wideDataToLong(options.dataShape),\n    processFixedOrder(options.fixedOrder),\n    validateAndSort,\n    fillDateGaps(options.fillDateGapsInterval, options.fillDateGapsValue, options.topN),\n    calculateLastValues,\n    storeDataCollections(store, changingOptions),\n  )(data);\n}\n\nfunction customDataTransform(transformFn: TransformFn | null) {\n  return function (data: Data[] | WideData[]): Data[] | WideData[] {\n    return transformFn && typeof transformFn === 'function' ? transformFn(data) : data;\n  };\n}\n\nfunction filterByDate(startDate: string, endDate: string) {\n  return function (data: Data[]): Data[] {\n    return data\n      .map((d) => ({ ...d, date: getDateString(d.date) }))\n      .filter((d) => (startDate ? d.date >= startDate : true))\n      .filter((d) => (endDate ? d.date <= endDate : true));\n  };\n}\n\nfunction processFixedOrder(fixedOrder: string[]) {\n  return function (data: Data[]) {\n    return fixedOrder.length === 0\n      ? data\n      : data\n          .filter((d) => fixedOrder.includes(d.name))\n          .map((d) => ({ ...d, rank: fixedOrder.indexOf(d.name) }));\n  };\n}\n\nfunction validateAndSort(data: Data[]): Data[] {\n  return data\n    .map((d) => {\n      const name = d.name ? d.name : '';\n      const value = isNaN(+d.value) ? 0 : +d.value;\n      return { ...d, name, value };\n    })\n    .sort((a, b) => a.date.localeCompare(b.date) || a.name.localeCompare(b.name));\n}\n\nfunction fillDateGaps(\n  fillDateGapsInterval: Options['fillDateGapsInterval'],\n  fillDateGapsValue: Options['fillDateGapsValue'],\n  topN: number,\n) {\n  return function (data: Data[]) {\n    return fillDateGapsInterval\n      ? fillGaps(data, fillDateGapsInterval, fillDateGapsValue, topN)\n      : data;\n  };\n}\n\nfunction storeDataCollections(store: Store, changingOptions: boolean) {\n  return function (data: Data[]) {\n    const names = Array.from(new Set(data.map((d) => String(d.name)))).sort();\n    const groups = Array.from(new Set(data.map((d) => String(d.group))))\n      .filter(Boolean)\n      .sort();\n    const dates = getDates(data);\n\n    store.dispatch(actions.data.dataLoaded({ names, groups }));\n    if (!changingOptions) {\n      store.dispatch(actions.ticker.initialize(dates));\n    } else {\n      store.dispatch(actions.ticker.changeDates(dates));\n    }\n    return data;\n  };\n}\n\nfunction calculateLastValues(data: Data[]) {\n  return data\n    .sort((a, b) => a.name.localeCompare(b.name) || a.date.localeCompare(b.date))\n    .reduce((acc: Data[], curr) => {\n      if (acc.length === 0) {\n        curr.lastValue = curr.value;\n      } else {\n        const last = acc[acc.length - 1];\n        if (curr.name === last.name) {\n          curr.lastValue = last.value;\n        } else {\n          curr.lastValue = curr.value;\n        }\n      }\n      return [...acc, curr];\n    }, []);\n}\n\nfunction wideDataToLong(dataShape: Options['dataShape'], nested = false) {\n  return function (data: WideData[]) {\n    if (dataShape === 'long') return data as Data[];\n\n    const long = [] as Data[];\n    data.forEach((row) => {\n      for (const [key, value] of Object.entries(row)) {\n        if (key === 'date') {\n          continue;\n        }\n\n        let item: any = {\n          date: row.date,\n          name: key,\n        };\n        if (nested) {\n          item = {\n            ...item,\n            ...value,\n          };\n        } else {\n          item = {\n            ...item,\n            value,\n          };\n        }\n        long.push(item);\n      }\n    });\n    return long;\n  };\n}\n\nfunction longDataToWide(long: Data[]) {\n  const wide = [] as WideData[];\n  long.forEach((item) => {\n    const dateRow = wide.filter((r) => r.date === item.date);\n    const row = dateRow.length > 0 ? dateRow[0] : ({} as WideData);\n    const { date, ...details } = item;\n    row[item.name] = details;\n    if (dateRow.length === 0) {\n      row.date = item.date;\n      wide.push(row);\n    }\n  });\n  return wide;\n}\n\nfunction fillGaps(\n  data: Data[],\n  interval: Options['fillDateGapsInterval'],\n  fillValue: Options['fillDateGapsValue'],\n  topN: number,\n) {\n  if (!interval) {\n    return data;\n  }\n\n  const wideData = longDataToWide(data).map((d) => ({ ...d, date: new Date(d.date) }));\n\n  const allData = wideData\n    .reduce(\n      (acc: any[], row, i) => {\n        const lastDate = acc[acc.length - 1].date;\n        const range = getDateRange(lastDate, row.date, interval).slice(1);\n\n        const rangeStep = 1 / range.length;\n        if (i < wideData.length) {\n          const iData = interpolateTopN(wideData[i - 1], wideData[i], topN);\n          const newData: any[] = [];\n          range.forEach((_, j) => {\n            const values = fillValue === 'last' ? iData(0) : iData((j + 1) * rangeStep);\n            const newRow: any = { date: range[j] };\n            for (const [key, value] of Object.entries(values)) {\n              if (key !== 'date') {\n                newRow[key] = { ...(value as any) };\n              }\n            }\n            newData.push(getDateString(row.date) === getDateString(newRow.date) ? row : newRow);\n          });\n          return [...acc, ...newData];\n        } else {\n          return [...acc];\n        }\n      },\n      [wideData[0]],\n    )\n    .map((d) => ({ ...d, date: getDateString(d.date) }));\n\n  return wideDataToLong('wide', true)(allData);\n}\n\n/** Interpolate only topN before and after the date range to improve performace */\nfunction interpolateTopN(data1: any = {}, data2: any = {}, topN: number) {\n  const topData1 = getTopN(data1, topN);\n  const topData2 = getTopN(data2, topN);\n  const topNames = Array.from(new Set([...topData1, ...topData2]));\n\n  const filteredData1 = topNames.reduce((obj, curr) => {\n    obj[curr] = data1[curr];\n    return obj;\n  }, {} as WideData);\n\n  const filteredData2 = topNames.reduce((obj, curr) => {\n    obj[curr] = data2[curr];\n    return obj;\n  }, {} as WideData);\n\n  return d3.interpolate(filteredData1, filteredData2);\n\n  function getTopN(data: { [key: string]: { name: string; value: number } } = {}, topN: number) {\n    return Object.keys(data)\n      .filter((key) => key !== 'date')\n      .map((key) => data[key])\n      .sort(function (a, b) {\n        return b.value - a.value;\n      })\n      .slice(0, topN)\n      .map((d) => d.name);\n  }\n}\n\nexport function getDateSlice(date: string, data: Data[], store: Store) {\n  let dateSlice: Data[];\n  if (store.getState().data.dateSlices[date]) {\n    // use cache\n    dateSlice = store.getState().data.dateSlices[date];\n  } else {\n    const slice = data\n      .filter((d) => d.date === date && !isNaN(d.value))\n      .sort((a, b) => b.value - a.value)\n      .map((d, i) => ({ ...d, rank: getRank(d, i, store) }));\n\n    const emptyData = [{ name: '', value: 0, lastValue: 0, date, rank: 1 }];\n    dateSlice = slice.length > 0 ? slice : emptyData;\n    // save to cache\n    store.dispatch(actions.data.addDateSlice(date, dateSlice));\n  }\n  const groupFilter = store.getState().data.groupFilter;\n  return groupFilter.length > 0 ? filterGroups(dateSlice, store) : dateSlice;\n}\n\nfunction filterGroups(data: Data[], store: Store) {\n  const groupFilter = store.getState().data.groupFilter;\n  return data\n    .filter((d) => (!!d.group ? !groupFilter.includes(d.group) : true))\n    .map((d, i) => ({ ...d, rank: getRank(d, i, store) }));\n}\n\nexport function computeNextDateSubscriber(data: Data[], store: Store) {\n  return function () {\n    if (store.getState().ticker.isRunning) {\n      const nextDate = getNextDate(\n        store.getState().ticker.dates,\n        store.getState().ticker.currentDate,\n      );\n      getDateSlice(nextDate, data, store);\n    }\n  };\n}\n\nfunction getRank(d: Data, i: number, store: Store) {\n  const fixedOrder = store.getState().options.fixedOrder;\n  return fixedOrder.length > 0 ? d.rank : i;\n}\n","import * as d3 from '../d3';\r\n\r\nimport { Data } from '../data';\r\nimport { Store } from '../store';\r\nimport { getHeight, getWidth } from '../utils';\r\nimport { RenderOptions } from './render-options';\r\n\r\nexport function calculateDimensions(store: Store, renderOptions: RenderOptions) {\r\n  const {\r\n    minHeight,\r\n    inputHeight,\r\n    minWidth,\r\n    inputWidth,\r\n    title,\r\n    subTitle,\r\n    showGroups,\r\n    controlButtons,\r\n    marginTop,\r\n    marginRight,\r\n    marginBottom,\r\n    marginLeft,\r\n    labelsPosition,\r\n    labelsWidth,\r\n    showIcons,\r\n    fixedOrder,\r\n  } = store.getState().options;\r\n  const { root, maxValue } = renderOptions;\r\n\r\n  const topN = fixedOrder.length > 0 ? fixedOrder.length : store.getState().options.topN;\r\n\r\n  const height = (renderOptions.height = getHeight(root, minHeight, inputHeight));\r\n  const width = (renderOptions.width = getWidth(root, minWidth, inputWidth));\r\n\r\n  const titlePadding = 5;\r\n  const titleHeight = title ? 55 : 0;\r\n  const subTitleHeight = !subTitle ? 0 : title ? 20 : 40;\r\n  const groupsHeight = !showGroups ? 0 : titleHeight || subTitleHeight ? 20 : 30;\r\n  const controlsHeight = controlButtons !== 'none' ? 50 : 0;\r\n\r\n  const headerHeight = Math.max(\r\n    titleHeight + subTitleHeight + groupsHeight,\r\n    controlsHeight + groupsHeight,\r\n    10,\r\n  );\r\n\r\n  const labelsArea = labelsPosition === 'inside' ? 0 : labelsWidth;\r\n  const topAxisPadding = 15;\r\n\r\n  const margin = {\r\n    top: marginTop + headerHeight + topAxisPadding,\r\n    right: marginRight,\r\n    bottom: marginBottom,\r\n    left: marginLeft + labelsArea,\r\n  };\r\n\r\n  const x = (renderOptions.x = d3\r\n    .scaleLinear()\r\n    .domain([0, maxValue])\r\n    .range([margin.left, width - margin.right - 65]));\r\n\r\n  const y = (renderOptions.y = d3\r\n    .scaleLinear()\r\n    .domain([topN, 0])\r\n    .range([height - margin.bottom, margin.top]));\r\n\r\n  const barPadding = (renderOptions.barPadding =\r\n    (height - (margin.bottom + margin.top)) / (topN * 5));\r\n  const labelPadding = (renderOptions.labelPadding = 8);\r\n  renderOptions.barWidth = (d: Data) => Math.abs(x(d.value) - x(0) - 1);\r\n  const barHeight = (renderOptions.barHeight = y(1) - y(0) - barPadding);\r\n  renderOptions.barHalfHeight = (y(1) - y(0)) / 2 + 1;\r\n  renderOptions.barY = (d: Data) => y(d.rank as number) + 5;\r\n  const iconSize = (renderOptions.iconSize = showIcons ? barHeight * 0.9 : 0);\r\n  const iconSpace = (renderOptions.iconSpace = showIcons ? iconSize + labelPadding : 0);\r\n  renderOptions.labelX =\r\n    labelsPosition === 'inside'\r\n      ? (d: Data) => x(d.value) - labelPadding - iconSpace\r\n      : margin.left - labelPadding;\r\n\r\n  renderOptions.titlePadding = titlePadding;\r\n  renderOptions.titleHeight = titleHeight;\r\n  renderOptions.margin = margin;\r\n}\r\n","import * as d3 from '../d3';\r\n\r\nimport { safeName, toggleClass, getClicks } from '../utils';\r\nimport { Store, actions } from '../store';\r\nimport { Data } from '../data';\r\nimport { RenderOptions } from './render-options';\r\n\r\nexport function halo(text: any, renderOptions: RenderOptions) {\r\n  renderOptions.svg //\r\n    .selectAll('.halo')\r\n    .remove();\r\n\r\n  text\r\n    .select(function () {\r\n      return this.parentNode.insertBefore(this.cloneNode(true), this);\r\n    })\r\n    .classed('halo', true);\r\n}\r\n\r\nexport function legendClick(d: string, store: Store) {\r\n  getClicks(d3.event, function (event: any) {\r\n    const clicks = event.detail;\r\n    if (clicks === 3) {\r\n      store.dispatch(actions.data.resetFilters());\r\n    } else if (clicks === 2) {\r\n      store.dispatch(actions.data.allExceptFilter(d));\r\n    } else {\r\n      store.dispatch(actions.data.toggleFilter(d));\r\n    }\r\n  });\r\n}\r\n\r\nexport function highlightFn(d: Data, store: Store, renderOptions: RenderOptions) {\r\n  if (store.getState().options.highlightBars) {\r\n    toggleClass(renderOptions.root, 'rect.' + safeName(d.name), 'highlight');\r\n  }\r\n}\r\n\r\nexport function selectFn(d: Data, store: Store, renderOptions: RenderOptions) {\r\n  if (store.getState().options.selectBars) {\r\n    toggleClass(renderOptions.root, 'rect.' + safeName(d.name), 'selected');\r\n    store.dispatch(actions.data.toggleSelection(d.name));\r\n  }\r\n}\r\n","import * as d3 from '../d3';\r\n\r\nimport { Data } from '../data';\r\nimport { Store } from '../store';\r\nimport { getText, getColor } from '../utils';\r\nimport { RenderOptions } from './render-options';\r\nimport { legendClick } from './helpers';\r\n\r\nexport function renderHeader(\r\n  store: Store,\r\n  renderOptions: RenderOptions,\r\n  CompleteDateSlice: Data[],\r\n) {\r\n  const groups = store.getState().data.groups;\r\n  const dates = store.getState().ticker.dates;\r\n  const currentDate = store.getState().ticker.currentDate;\r\n  const { title, subTitle, marginTop, marginLeft, showGroups } = store.getState().options;\r\n  const { svg, margin, width, titlePadding, titleHeight } = renderOptions;\r\n\r\n  renderOptions.titleText = svg\r\n    .append('text')\r\n    .attr('class', 'title')\r\n    .attr('x', marginLeft + titlePadding)\r\n    .attr('y', marginTop + 24)\r\n    .html(getText(title, currentDate, CompleteDateSlice, dates));\r\n\r\n  renderOptions.subTitleText = svg\r\n    .append('text')\r\n    .attr('class', 'subTitle')\r\n    .attr('x', marginLeft + titlePadding)\r\n    .attr('y', marginTop + (titleHeight || 24))\r\n    .html(getText(subTitle, currentDate, CompleteDateSlice, dates));\r\n\r\n  if (showGroups) {\r\n    const legendsWrapper = svg.append('g');\r\n    const legends = legendsWrapper\r\n      .selectAll('.legend-wrapper')\r\n      .data(groups)\r\n      .enter()\r\n      .append('g')\r\n      .attr('class', 'legend legend-wrapper')\r\n      .style('cursor', 'pointer')\r\n      .style('opacity', (d: string) => (store.getState().data.groupFilter.includes(d) ? 0.3 : 1))\r\n      .on('click', (d: string) => legendClick(d, store));\r\n\r\n    legends\r\n      .append('rect')\r\n      .attr('class', 'legend legend-color')\r\n      .attr('width', 10)\r\n      .attr('height', 10)\r\n      .attr('y', margin.top - 35)\r\n      .style('fill', (d: string) => getColor({ group: d } as Data, store) as string);\r\n\r\n    legends\r\n      .append('text')\r\n      .attr('class', 'legend legend-text')\r\n      .attr('x', 20)\r\n      .attr('y', margin.top - 25)\r\n      .html((d: string) => d);\r\n\r\n    let legendX = margin.left + titlePadding;\r\n    let legendY = 0;\r\n    legends.each(function () {\r\n      const wrapper = d3.select(this);\r\n      const text = wrapper.select('text') as any;\r\n      const bbox = text.node().getBBox();\r\n      if (legendX + bbox.width > width) {\r\n        legendX = margin.left + titlePadding;\r\n        legendY += 30;\r\n      }\r\n      wrapper.attr('transform', 'translate(' + legendX + ', ' + legendY + ')');\r\n      legendX += bbox.width + 40;\r\n    });\r\n\r\n    margin.top += legendY;\r\n  }\r\n}\r\n","export const elements = {\r\n  controls: 'controls',\r\n  skipBack: 'skipBack',\r\n  play: 'play',\r\n  pause: 'pause',\r\n  skipForward: 'skipForward',\r\n  overlay: 'overlay',\r\n  overlayPlay: 'overlayPlay',\r\n  overlayRepeat: 'overlayRepeat',\r\n};\r\n","export const buttons = {\r\n  skipBack: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M28.46,4a3,3,0,0,0-3,.07l-15.2,9.41A3,3,0,0,0,9,15V5A3,3,0,0,0,6,2H5A3,3,0,0,0,2,5V27a3,3,0,0,0,3,3H6a3,3,0,0,0,3-3V17a3,3,0,0,0,1.22,1.53L25.42,28a3,3,0,0,0,1.58.46,3,3,0,0,0,3-3V6.59A3,3,0,0,0,28.46,4Z\"/></g></svg>`,\r\n  play: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M26.78,13.45,11.58,4A3,3,0,0,0,7,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,11.58,28l15.2-9.41a3,3,0,0,0,0-5.1Z\"/></g></svg>`,\r\n  pause: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns:svg=\"http://www.w3.org/2000/svg\"><g transform=\"translate(-17)\"><path d=\"m 27,2 h -1 c -1.656854,0 -3,1.3431458 -3,3 v 12 c -0.04755,3.269656 0,6.666667 0,10 0,1.656854 1.343146,3 3,3 h 1 c 1.656854,0 3,-1.343146 3,-3 V 5 C 30,3.3431458 28.656854,2 27,2 Z\" /></g><g transform=\"translate(-4)\"><path d=\"m 27,2 h -1 c -1.656854,0 -3,1.3431458 -3,3 v 12 c -0.04755,3.269656 0,6.666667 0,10 0,1.656854 1.343146,3 3,3 h 1 c 1.656854,0 3,-1.343146 3,-3 V 5 C 30,3.3431458 28.656854,2 27,2 Z\" /></g></svg>`,\r\n  skipForward: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M27,2H26a3,3,0,0,0-3,3V15a3,3,0,0,0-1.22-1.53L6.58,4A3,3,0,0,0,2,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,6.58,28l15.2-9.41A3,3,0,0,0,23,17V27a3,3,0,0,0,3,3h1a3,3,0,0,0,3-3V5A3,3,0,0,0,27,2Z\"/></g></svg>`,\r\n  overlayPlay: `<svg viewBox=\"0 0 32 32\" fill=\"currentColor\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M26.78,13.45,11.58,4A3,3,0,0,0,7,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,11.58,28l15.2-9.41a3,3,0,0,0,0-5.1Z\"/></g></svg>`,\r\n  overlayRepeat: `<svg viewBox=\"0 0 32 32\" fill=\"currentColor\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M18,4A12,12,0,0,0,6.05,15H3a1,1,0,0,0-.88.53,1,1,0,0,0,0,1l4,6a1,1,0,0,0,1.66,0l4-6a1,1,0,0,0,.05-1A1,1,0,0,0,11,15H8.05A10,10,0,1,1,18,26a1,1,0,0,0,0,2A12,12,0,0,0,18,4Z\"/></g></svg>`,\r\n};\r\n","import * as d3 from '../d3';\n\nimport { Store } from '../store';\nimport { hideElement, showElement } from '../utils';\nimport { elements } from './elements';\nimport { buttons } from './buttons';\nimport { RenderOptions } from './render-options';\n\nexport function renderControls(store: Store, renderOptions: RenderOptions) {\n  const { marginTop, controlButtons } = store.getState().options;\n  const { root, width, margin, barPadding } = renderOptions;\n\n  const elementWidth = root.getBoundingClientRect().width;\n  const controlButtonIcons = [\n    { skipBack: buttons.skipBack },\n    { play: buttons.play },\n    { pause: buttons.pause },\n    { skipForward: buttons.skipForward },\n  ];\n\n  d3.select(root)\n    .append('div')\n    .classed('controls', true)\n    .style('position', 'absolute')\n    .style('top', marginTop + 'px')\n    .style('right', elementWidth - width + margin.right + barPadding + 'px')\n    .selectAll('div')\n    .data(controlButtonIcons)\n    .enter()\n    .append('div')\n    .html((d) => Object.values(d)[0] as string)\n    .attr('class', (d) => Object.keys(d)[0]);\n\n  if (controlButtons === 'play') {\n    hideElement(root, elements.skipBack);\n    hideElement(root, elements.skipForward);\n  }\n  if (controlButtons === 'none') {\n    hideElement(root, elements.controls);\n  }\n}\n\nexport function updateControls(store: Store, renderOptions: RenderOptions) {\n  const { overlays, loop } = store.getState().options;\n  const { root } = renderOptions;\n\n  if (store.getState().ticker.isRunning) {\n    showElement(root, elements.pause);\n    hideElement(root, elements.play);\n  } else {\n    showElement(root, elements.play);\n    hideElement(root, elements.pause);\n  }\n\n  if (\n    store.getState().ticker.isFirstDate &&\n    (overlays === 'all' || overlays === 'play') &&\n    !store.getState().ticker.isRunning\n  ) {\n    hideElement(root, elements.controls, true);\n    showElement(root, elements.overlay);\n    showElement(root, elements.overlayPlay);\n    hideElement(root, elements.overlayRepeat);\n  } else if (\n    store.getState().ticker.isLastDate &&\n    (overlays === 'all' || overlays === 'repeat') &&\n    !(loop && store.getState().ticker.isRunning)\n  ) {\n    hideElement(root, elements.controls, true);\n    showElement(root, elements.overlay);\n    showElement(root, elements.overlayRepeat);\n    hideElement(root, elements.overlayPlay);\n  } else {\n    showElement(root, elements.controls, true);\n    hideElement(root, elements.overlay);\n  }\n}\n\nexport function renderOverlays(store: Store, renderOptions: RenderOptions) {\n  const { minHeight, minWidth } = store.getState().options;\n  const { root } = renderOptions;\n\n  const overlayButtonIcons = [\n    { overlayPlay: buttons.overlayPlay },\n    { overlayRepeat: buttons.overlayRepeat },\n  ];\n\n  d3.select(root)\n    .append('div')\n    .classed('overlay', true)\n    .style('minHeight', minHeight + 'px')\n    .style('minWidth', minWidth + 'px')\n    .selectAll('div')\n    .data(overlayButtonIcons)\n    .enter()\n    .append('div')\n    .html((d) => Object.values(d)[0] as string)\n    .attr('class', (d) => Object.keys(d)[0]);\n}\n","import * as d3 from '../d3';\n\nimport { Store } from '../store';\nimport { Data } from '../data';\nimport { getDateSlice } from '../data-utils';\nimport { getText, getColor, safeName, getIconID } from '../utils';\nimport { RenderOptions } from './render-options';\nimport { calculateDimensions } from './calculate-dimensions';\nimport { renderHeader } from './render-header';\nimport { renderControls, renderOverlays, updateControls } from './controls';\nimport { selectFn, highlightFn, halo } from './helpers';\n\nexport function renderInitalView(data: Data[], store: Store, renderOptions: RenderOptions) {\n  const {\n    selector,\n    caption,\n    dateCounter,\n    labelsPosition,\n    showIcons,\n    fixedScale,\n    fixedOrder,\n  } = store.getState().options;\n\n  const dates = store.getState().ticker.dates;\n  const root = (renderOptions.root = document.querySelector(selector) as HTMLElement);\n  const topN = fixedOrder.length > 0 ? fixedOrder.length : store.getState().options.topN;\n  const currentDate = store.getState().ticker.currentDate;\n  const CompleteDateSlice = getDateSlice(currentDate, data, store);\n  const dateSlice = CompleteDateSlice.slice(0, topN);\n  const lastDateIndex = dates.indexOf(currentDate) > 0 ? dates.indexOf(currentDate) - 1 : 0;\n  renderOptions.lastDate = dates[lastDateIndex];\n\n  if (!root || dateSlice.length === 0) return;\n\n  root.innerHTML = '';\n\n  renderInitialFrame();\n  renderControls(store, renderOptions);\n  renderOverlays(store, renderOptions);\n  updateControls(store, renderOptions);\n\n  function renderInitialFrame() {\n    renderOptions.maxValue = fixedScale\n      ? data.map((d) => d.value).reduce((max, val) => (max > val ? max : val), 0)\n      : (d3.max(dateSlice, (d: Data) => d.value) as number);\n\n    calculateDimensions(store, renderOptions);\n\n    const {\n      margin,\n      width,\n      height,\n      x,\n      y,\n      barWidth,\n      barHeight,\n      barY,\n      barHalfHeight,\n      labelX,\n      iconSize,\n      labelPadding,\n    } = renderOptions;\n\n    const svg: any = (renderOptions.svg = d3\n      .select(root)\n      .append('svg')\n      .attr('width', width)\n      .attr('height', height));\n\n    renderHeader(store, renderOptions, CompleteDateSlice);\n\n    const xAxis = (renderOptions.xAxis = d3\n      .axisTop(x)\n      .ticks(width > 500 ? 5 : 2)\n      .tickSize(-(height - (margin.top + margin.bottom)))\n      .tickFormat((n: number | { valueOf(): number }) => d3.format(',')(n)));\n\n    svg\n      .append('g')\n      .attr('class', 'axis xAxis')\n      .attr('transform', `translate(0, ${margin.top})`)\n      .call(xAxis)\n      .selectAll('.tick line')\n      .classed('origin', (d: unknown) => d === 0);\n\n    svg\n      .selectAll('rect.bar')\n      .data(dateSlice, (d: Data) => d.name)\n      .enter()\n      .append('rect')\n      .attr('class', (d: Data) => 'bar ' + safeName(d.name))\n      .classed('selected', (d: Data) => store.getState().data.selected.includes(d.name))\n      .attr('x', x(0) + 1)\n      .attr('width', barWidth)\n      .attr('y', barY)\n      .attr('height', barHeight)\n      .style('fill', (d: Data) => getColor(d, store))\n      .on('click', (d: Data) => selectFn(d, store, renderOptions))\n      .on('mouseover', (d: Data) => highlightFn(d, store, renderOptions))\n      .on('mouseout', (d: Data) => highlightFn(d, store, renderOptions));\n\n    svg\n      .selectAll('text.label')\n      .data(dateSlice, (d: Data) => d.name)\n      .enter()\n      .append('text')\n      .attr('class', 'label')\n      .classed('outside-bars', labelsPosition !== 'inside')\n      .attr('x', labelX)\n      .attr('y', (d: Data) => barY(d) + barHalfHeight)\n      .style('text-anchor', 'end')\n      .html((d: Data) => d.name)\n      .on('click', (d: Data) => selectFn(d, store, renderOptions))\n      .on('mouseover', (d: Data) => highlightFn(d, store, renderOptions))\n      .on('mouseout', (d: Data) => highlightFn(d, store, renderOptions));\n\n    svg\n      .selectAll('text.valueLabel')\n      .data(dateSlice, (d: Data) => d.name)\n      .enter()\n      .append('text')\n      .attr('class', 'valueLabel')\n      .attr('x', (d: Data) => x(d.value) + 5)\n      .attr('y', (d: Data) => barY(d) + barHalfHeight)\n      .text((d: Data) => d3.format(',.0f')(d.lastValue as number));\n\n    if (showIcons) {\n      const defs = (renderOptions.defs = svg.append('svg:defs'));\n\n      defs\n        .selectAll('svg')\n        .data(dateSlice, (d: Data) => d.name)\n        .enter()\n        .append('svg:pattern')\n        .attr('class', 'svgpattern')\n        .attr('id', getIconID)\n        .attr('width', iconSize)\n        .attr('height', iconSize)\n        .append('svg:image')\n        .attr('xlink:href', (d: Data) => d.icon)\n        .attr('width', iconSize)\n        .attr('height', iconSize)\n        .attr('x', 0)\n        .attr('y', 0);\n\n      svg\n        .selectAll('circle')\n        .data(dateSlice, (d: Data) => d.name)\n        .enter()\n        .append('circle')\n        .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\n        .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight)\n        .attr('r', iconSize / 2)\n        .style('fill', 'transparent')\n        .style('fill', (d: Data) => `url(#${getIconID(d)})`);\n    }\n\n    const endY = height - margin.bottom;\n    const endX = width - margin.right;\n    const dateCounterTextY = caption ? endY - 30 : endY - 5;\n    renderOptions.dateCounterText = svg\n      .append('text')\n      .attr('class', 'dateCounterText')\n      .attr('x', endX)\n      .attr('y', dateCounterTextY)\n      .style('text-anchor', 'end')\n      .html(getText(dateCounter, currentDate, CompleteDateSlice, dates, true))\n      .call((text: any) => halo(text, renderOptions));\n\n    renderOptions.captionText = svg\n      .append('text')\n      .attr('class', 'caption')\n      .attr('x', endX - 10)\n      .attr('y', endY - 5)\n      .style('text-anchor', 'end')\n      .html(getText(caption, currentDate, CompleteDateSlice, dates));\n  }\n}\n","import * as d3 from '../d3';\r\n\r\nimport { Data } from '../data';\r\nimport { Store } from '../store';\r\nimport { getDateSlice } from '../data-utils';\r\nimport { safeName, getColor, getIconID, getText } from '../utils';\r\nimport { RenderOptions } from './render-options';\r\nimport { selectFn, highlightFn, halo } from './helpers';\r\nimport { updateControls } from './controls';\r\n\r\nexport function renderFrame(data: Data[], store: Store, renderOptions: RenderOptions) {\r\n  const {\r\n    svg,\r\n    titleText,\r\n    subTitleText,\r\n    dateCounterText,\r\n    captionText,\r\n    x,\r\n    y,\r\n    xAxis,\r\n    labelPadding,\r\n    barWidth,\r\n    barHeight,\r\n    barHalfHeight,\r\n    barY,\r\n    iconSize,\r\n    labelX,\r\n    defs,\r\n    lastDate,\r\n  } = renderOptions;\r\n  const dates = store.getState().ticker.dates;\r\n  const { showGroups } = store.getState().options;\r\n\r\n  if (!x) {\r\n    return;\r\n  }\r\n\r\n  const {\r\n    tickDuration,\r\n    title,\r\n    subTitle,\r\n    caption,\r\n    dateCounter,\r\n    marginBottom,\r\n    fixedScale,\r\n    fixedOrder,\r\n    labelsPosition,\r\n  } = store.getState().options;\r\n\r\n  const topN = fixedOrder.length > 0 ? fixedOrder.length : store.getState().options.topN;\r\n  const currentDate = store.getState().ticker.currentDate;\r\n  const CompleteDateSlice = getDateSlice(currentDate, data, store);\r\n  const dateSlice = CompleteDateSlice.slice(0, topN);\r\n\r\n  if (showGroups) {\r\n    svg\r\n      .selectAll('.legend-wrapper')\r\n      .style('opacity', (d: string) => (store.getState().data.groupFilter.includes(d) ? 0.3 : 1));\r\n  }\r\n\r\n  if (!fixedScale) {\r\n    x.domain([0, d3.max(dateSlice, (d: Data) => d.value) as number]);\r\n\r\n    svg //\r\n      .select('.xAxis')\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .call(xAxis);\r\n  }\r\n\r\n  const bars = svg //\r\n    .selectAll('.bar')\r\n    .data(dateSlice, (d: Data) => d.name);\r\n\r\n  bars\r\n    .enter()\r\n    .append('rect')\r\n    .attr('class', (d: Data) => 'bar ' + safeName(d.name))\r\n    .classed('selected', (d: Data) => store.getState().data.selected.includes(d.name))\r\n    .attr('x', x(0) + 1)\r\n    .attr('width', barWidth)\r\n    .attr('y', () => y(topN + 1) + marginBottom + 5)\r\n    .attr('height', barHeight)\r\n    .style('fill', (d: Data) => getColor(d, store))\r\n    .on('click', (d: Data) => selectFn(d, store, renderOptions))\r\n    .on('mouseover', (d: Data) => highlightFn(d, store, renderOptions))\r\n    .on('mouseout', (d: Data) => highlightFn(d, store, renderOptions))\r\n    .transition()\r\n    .duration(tickDuration)\r\n    .ease(d3.easeLinear)\r\n    .attr('y', barY);\r\n\r\n  bars\r\n    .transition()\r\n    .duration(tickDuration)\r\n    .ease(d3.easeLinear)\r\n    .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\r\n    .attr('y', barY);\r\n\r\n  bars\r\n    .exit()\r\n    .transition()\r\n    .duration(tickDuration)\r\n    .ease(d3.easeLinear)\r\n    .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\r\n    .attr('y', () => y(topN + 1) + marginBottom + 5)\r\n    .remove();\r\n\r\n  const labels = svg //\r\n    .selectAll('.label')\r\n    .data(dateSlice, (d: Data) => d.name);\r\n\r\n  labels\r\n    .enter()\r\n    .append('text')\r\n    .attr('class', 'label')\r\n    .classed('outside-bars', labelsPosition !== 'inside')\r\n    .attr('x', labelX)\r\n    .attr('y', () => y(topN + 1) + marginBottom + 5 + barHalfHeight)\r\n    .style('text-anchor', 'end')\r\n    .html((d: Data) => d.name)\r\n    .on('click', (d: Data) => selectFn(d, store, renderOptions))\r\n    .on('mouseover', (d: Data) => highlightFn(d, store, renderOptions))\r\n    .on('mouseout', (d: Data) => highlightFn(d, store, renderOptions))\r\n    .transition()\r\n    .duration(tickDuration)\r\n    .ease(d3.easeLinear)\r\n    .attr('y', (d: Data) => barY(d) + barHalfHeight);\r\n\r\n  labels\r\n    .transition()\r\n    .duration(tickDuration)\r\n    .ease(d3.easeLinear)\r\n    .attr('x', labelX)\r\n    .attr('y', (d: Data) => barY(d) + barHalfHeight);\r\n\r\n  labels\r\n    .exit()\r\n    .transition()\r\n    .duration(tickDuration)\r\n    .ease(d3.easeLinear)\r\n    .attr('x', labelX)\r\n    .attr('y', () => y(topN + 1) + marginBottom + 5)\r\n    .remove();\r\n\r\n  const valueLabels = svg //\r\n    .selectAll('.valueLabel')\r\n    .data(dateSlice, (d: Data) => d.name);\r\n\r\n  valueLabels\r\n    .enter()\r\n    .append('text')\r\n    .attr('class', 'valueLabel')\r\n    .attr('x', (d: Data) => x(d.value) + 5)\r\n    .attr('y', () => y(topN + 1) + marginBottom + 5)\r\n    .text((d: Data) => d3.format(',.0f')(d.lastValue as number))\r\n    .transition()\r\n    .duration(tickDuration)\r\n    .ease(d3.easeLinear)\r\n    .attr('y', (d: Data) => barY(d) + barHalfHeight);\r\n\r\n  const sameDate = lastDate === currentDate;\r\n  valueLabels\r\n    .transition()\r\n    .duration(tickDuration)\r\n    .ease(d3.easeLinear)\r\n    .attr('x', (d: Data) => x(d.value) + 5)\r\n    .attr('y', (d: Data) => barY(d) + barHalfHeight)\r\n    .tween('text', function (d: Data) {\r\n      const lastValue = sameDate ? d.value : (d.lastValue as number);\r\n      const i = d3.interpolateRound(lastValue, d.value);\r\n      return function (t: number) {\r\n        this.textContent = d3.format(',')(i(t));\r\n      };\r\n    });\r\n\r\n  valueLabels\r\n    .exit()\r\n    .transition()\r\n    .duration(tickDuration)\r\n    .ease(d3.easeLinear)\r\n    .attr('x', (d: Data) => x(d.value) + 5)\r\n    .attr('y', () => y(topN + 1) + marginBottom + 5)\r\n    .remove();\r\n\r\n  if (store.getState().options.showIcons) {\r\n    const iconPatterns = defs.selectAll('.svgpattern').data(dateSlice, (d: Data) => d.name);\r\n\r\n    iconPatterns\r\n      .enter()\r\n      .append('svg:pattern')\r\n      .attr('class', 'svgpattern')\r\n      .attr('id', getIconID)\r\n      .attr('width', iconSize)\r\n      .attr('height', iconSize)\r\n      .append('svg:image')\r\n      .attr('xlink:href', (d: Data) => d.icon)\r\n      .attr('width', iconSize)\r\n      .attr('height', iconSize)\r\n      .style('z-index', '99')\r\n      .attr('x', 0)\r\n      .attr('y', 0);\r\n\r\n    iconPatterns //\r\n      .exit()\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .remove();\r\n\r\n    const icons = svg //\r\n      .selectAll('circle')\r\n      .data(dateSlice, (d: Data) => d.name);\r\n\r\n    icons\r\n      .enter()\r\n      .append('circle')\r\n      .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\r\n      .attr('cy', () => y(topN + 1) + iconSize + barHalfHeight)\r\n      .attr('r', iconSize / 2)\r\n      .style('z-index', '99')\r\n      .style('fill', 'transparent')\r\n      .style('fill', (d: Data) => `url(#${getIconID(d)})`)\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight);\r\n\r\n    icons\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\r\n      .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight);\r\n\r\n    icons\r\n      .exit()\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\r\n      .attr('cy', () => y(topN + 1) + iconSize + barHalfHeight)\r\n      .remove();\r\n  }\r\n\r\n  titleText.html(getText(title, currentDate, CompleteDateSlice, dates));\r\n  subTitleText.html(getText(subTitle, currentDate, CompleteDateSlice, dates));\r\n  captionText.html(getText(caption, currentDate, CompleteDateSlice, dates));\r\n  dateCounterText\r\n    .html(getText(dateCounter, currentDate, CompleteDateSlice, dates, true))\r\n    .call((text: any) => halo(text, renderOptions));\r\n\r\n  updateControls(store, renderOptions);\r\n\r\n  renderOptions.lastDate = currentDate;\r\n}\r\n","import { getHeight, getWidth } from '../utils';\r\nimport { Store } from '../store';\r\nimport { Data } from '../data';\r\nimport { RenderOptions } from './render-options';\r\nimport { renderInitalView } from './render-initial-view';\r\nimport { renderFrame } from './render-frame';\r\nimport { updateControls } from './controls';\r\n\r\nexport function resize(data: Data[], store: Store, renderOptions: RenderOptions) {\r\n  const { inputHeight, inputWidth, minHeight, minWidth } = store.getState().options;\r\n  const { root } = renderOptions;\r\n\r\n  if (!root) return;\r\n\r\n  if (\r\n    (!inputHeight && !inputWidth) ||\r\n    String(inputHeight).startsWith('window') ||\r\n    String(inputWidth).startsWith('window')\r\n  ) {\r\n    renderOptions.height = getHeight(root, minHeight, inputHeight);\r\n    renderOptions.width = getWidth(root, minWidth, inputWidth);\r\n\r\n    const currentPosition = root.style.position; // \"fixed\" if scrolling\r\n\r\n    renderInitalView(data, store, renderOptions);\r\n    renderFrame(data, store, renderOptions);\r\n    renderFrame(data, store, renderOptions); // workaround to avoid showing lastValue\r\n    updateControls(store, renderOptions);\r\n\r\n    root.style.position = currentPosition;\r\n  }\r\n}\r\n","import { Data } from '../data';\r\nimport { Store } from '../store';\r\nimport { Renderer } from './renderer.models';\r\nimport { renderInitalView } from './render-initial-view';\r\nimport { renderFrame } from './render-frame';\r\nimport { resize } from './resize';\r\nimport { RenderOptions } from './render-options';\r\n\r\nexport function createRenderer(data: Data[], store: Store): Renderer {\r\n  const renderOptions = {} as RenderOptions;\r\n\r\n  return {\r\n    renderInitalView: () => renderInitalView(data, store, renderOptions),\r\n    renderFrame: () => renderFrame(data, store, renderOptions),\r\n    resize: () => resize(data, store, renderOptions),\r\n  };\r\n}\r\n","import { Store } from '../store';\r\nimport { Renderer } from './renderer.models';\r\n\r\nexport function rendererSubscriber(store: Store, renderer: Renderer) {\r\n  return function () {\r\n    if (store.getState().triggerRender) {\r\n      renderer.renderFrame();\r\n    }\r\n  };\r\n}\r\n","// This file is auto-generated and will be over-written!\n// Please do NOT edit this file directly\n// You may edit files in this folder instead: src\\lib\\css\n\nexport const styles = `\n__selector__ text {\n  font-size: 16px;\n  font-family: Open Sans, sans-serif;\n}\n\n__selector__ text.title {\n  font-size: 24px;\n  font-weight: 500;\n}\n\n__selector__ text.subTitle {\n  font-weight: 500;\n}\n\n__selector__ text.caption {\n  font-weight: 400;\n  font-size: 24px;\n}\n__selector__ text.legend-text {\n  user-select: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n}\n__selector__ text.label {\n  font-weight: 600;\n}\n\n__selector__ text.valueLabel {\n  font-weight: 300;\n}\n\n__selector__ text.dateCounterText {\n  font-size: 64px;\n  font-weight: 700;\n}\n\n__selector__ .xAxis .tick:nth-child(2) text {\n  text-anchor: start;\n}\n\n__selector__ .tick line {\n  shape-rendering: CrispEdges;\n}\n\n__selector__ path.domain {\n  display: none;\n}\n\n__selector__ {\n  position: relative;\n}\n\n__selector__ .controls {\n  /*  position is set dynamically in renderer.ts */\n  display: flex;\n}\n\n__selector__ .controls div,\n__selector__ .overlay div {\n  cursor: pointer;\n  font-size: 24px;\n  font-weight: 700;\n  width: 38px;\n  height: 38px;\n  -moz-border-radius: 5px;\n  -webkit-border-radius: 5px;\n  border-radius: 5px;\n  margin: 5px;\n  text-align: center;\n}\n\n__selector__ .controls svg {\n  margin: 5px auto;\n  width: 28px;\n  height: 28px;\n}\n\n__selector__ .overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n__selector__ .overlay div {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 200px;\n  height: 200px;\n  -moz-border-radius: 100px;\n  -webkit-border-radius: 100px;\n  border-radius: 100px;\n}\n__selector__ .overlay svg {\n  height: 50%;\n  width: 50%;\n}\n`;\n\nexport const themes = {\n\"dark\": `\n__selector__ {\r\n  background-color: #313639;\r\n}\r\n\r\n__selector__ text.title {\r\n  fill: #fafafa;\r\n}\r\n\r\n__selector__ text.subTitle {\r\n  fill: #cccccc;\r\n}\r\n\r\n__selector__ text.dateCounterText {\r\n  fill: #cccccc;\r\n  opacity: 1;\r\n}\r\n\r\n__selector__ text.caption {\r\n  fill: #cccccc;\r\n}\r\n\r\n__selector__ .halo {\r\n  fill: #313639;\r\n  stroke: #313639;\r\n  stroke-width: 10;\r\n  stroke-linejoin: round;\r\n  opacity: 1;\r\n}\r\n\r\n__selector__ text.legend-text {\r\n  fill: #fafafa;\r\n}\r\n\r\n__selector__ text.label {\r\n  fill: #313639;\r\n}\r\n\r\n__selector__ text.label.outside-bars {\r\n  fill: #fafafa;\r\n}\r\n\r\n__selector__ text.valueLabel {\r\n  fill: #fafafa;\r\n}\r\n\r\n__selector__ .tick text {\r\n  fill: #cccccc;\r\n}\r\n\r\n__selector__ .tick line {\r\n  shape-rendering: CrispEdges;\r\n  stroke: #dddddd;\r\n}\r\n\r\n__selector__ .tick line.origin {\r\n  stroke: #aaaaaa;\r\n}\r\n\r\n__selector__ .controls div,\r\n__selector__ .overlay div {\r\n  color: #ffffff;\r\n  background: #777777;\r\n  border: 1px solid black;\r\n  opacity: 0.5;\r\n}\r\n\r\n__selector__ .controls div:hover,\r\n__selector__ .overlay div:hover {\r\n  background: #aaaaaa;\r\n  color: black;\r\n}\r\n\r\n__selector__ .overlay {\r\n  background-color: black;\r\n  opacity: 0.7;\r\n}\r\n\r\n__selector__ .highlight {\r\n  fill: #ff2727 !important;\r\n}\r\n\r\n__selector__ .selected {\r\n  fill: #d12020 !important;\r\n  stroke: #777777 !important;\r\n  stroke-width: 1 !important;\r\n}\r\n`,\n\"light\": `\n/* __selector__ {\r\n  background-color: #ffffff;\r\n}\r\n\r\n__selector__ text.title {\r\n  fill: #fafafa;\r\n} */\r\n\r\n__selector__ text.subTitle {\r\n  fill: #777777;\r\n}\r\n\r\n__selector__ text.dateCounterText {\r\n  fill: #bbbbbb;\r\n  opacity: 1;\r\n}\r\n\r\n__selector__ text.caption {\r\n  fill: #777777;\r\n}\r\n\r\n__selector__ .halo {\r\n  fill: #ffffff;\r\n  stroke: #ffffff;\r\n  stroke-width: 10;\r\n  stroke-linejoin: round;\r\n  opacity: 1;\r\n}\r\n\r\n__selector__ text.legend-text {\r\n  fill: #000000;\r\n}\r\n\r\n__selector__ text.label {\r\n  fill: #000000;\r\n}\r\n\r\n__selector__ text.label.outside-bars {\r\n  fill: #000000;\r\n}\r\n\r\n__selector__ text.valueLabel {\r\n  fill: #000000;\r\n}\r\n\r\n__selector__ .tick text {\r\n  fill: #777777;\r\n}\r\n\r\n__selector__ .tick line {\r\n  shape-rendering: CrispEdges;\r\n  stroke: #dddddd;\r\n}\r\n\r\n__selector__ .tick line.origin {\r\n  stroke: #aaaaaa;\r\n}\r\n\r\n__selector__ .controls div,\r\n__selector__ .overlay div {\r\n  color: #ffffff;\r\n  background: #777777;\r\n  border: 1px solid black;\r\n  opacity: 0.5;\r\n}\r\n\r\n__selector__ .controls div:hover,\r\n__selector__ .overlay div:hover {\r\n  background: #aaaaaa;\r\n  color: black;\r\n}\r\n\r\n__selector__ .overlay {\r\n  background-color: black;\r\n  opacity: 0.7;\r\n}\r\n\r\n__selector__ .highlight {\r\n  fill: #ff2727 !important;\r\n}\r\n\r\n__selector__ .selected {\r\n  fill: #d12020 !important;\r\n  stroke: #777777 !important;\r\n  stroke-width: 1 !important;\r\n}\r\n`,\n};\n","import { generateId } from '../utils';\nimport { styles, themes } from './generated-styles';\n\n// modifed from https://github.com/egoist/style-inject\nexport function styleInject(selector: string, theme: string, insertAt = 'top') {\n  let css = styles + (themes as any)[theme];\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  // replace with selector\n  css = css.split('__selector__').join(selector);\n\n  const head = document.head || document.getElementsByTagName('head')[0];\n  const style = document.createElement('style') as HTMLStyleElement | any;\n  style.id = generateId('styles');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n\n  return style.id;\n}\n","import { elements } from './renderer';\nimport { Store } from './store';\nimport { Ticker } from './ticker';\nimport { hideElement, getElement, getClicks } from './utils';\nimport { DOMCustomEvent } from './models';\n\nexport function registerEvents(store: Store, ticker: Ticker) {\n  const root = document.querySelector(store.getState().options.selector) as HTMLElement;\n  const events: Array<{\n    element: HTMLElement | Document;\n    event: string;\n    handler: EventListener;\n  }> = [];\n\n  registerControlButtonEvents();\n  registerOverlayEvents();\n  registerClickEvents();\n  registerKeyboardEvents();\n  return { unregister };\n\n  function registerControlButtonEvents() {\n    addEventHandler(root, elements.skipBack, 'click', () => ticker.skipBack());\n    addEventHandler(root, elements.play, 'click', () => ticker.start());\n    addEventHandler(root, elements.pause, 'click', () => ticker.stop());\n    addEventHandler(root, elements.skipForward, 'click', () => ticker.skipForward());\n  }\n\n  function registerOverlayEvents() {\n    addEventHandler(root, elements.overlayPlay, 'click', () => {\n      hideElement(root, elements.overlay);\n      ticker.start();\n    });\n    addEventHandler(root, elements.overlayRepeat, 'click', () => {\n      hideElement(root, elements.overlay);\n      ticker.skipBack();\n      ticker.start();\n    });\n  }\n\n  function registerClickEvents() {\n    if (store.getState().options.mouseControls) {\n      const svg = root.querySelector('svg') as SVGSVGElement;\n      svg.addEventListener('click', (clickEvent) => {\n        // ignore clicks to group legends\n        const target = clickEvent.target as HTMLElement;\n        if (!target || target.classList.contains('legend')) return;\n\n        getClicks(clickEvent, function (event: any) {\n          const clicks = event.detail;\n          if (clicks === 3) {\n            ticker.skipBack();\n          } else if (clicks === 2) {\n            ticker.skipForward();\n          } else {\n            ticker.toggle();\n          }\n        });\n      });\n    }\n  }\n\n  function registerKeyboardEvents() {\n    if (store.getState().options.keyboardControls) {\n      document.addEventListener('keyup', handleKeyboardEvents);\n      events.push({\n        element: document,\n        event: 'keyup',\n        handler: handleKeyboardEvents as EventListener,\n      });\n    }\n  }\n\n  function handleKeyboardEvents(e: KeyboardEvent) {\n    // ignore keyboard when user is typing in input or textarea\n    const target = document.activeElement;\n    if (target && ['input', 'textarea'].includes(target.tagName.toLowerCase())) return;\n\n    const keys = {\n      spacebar: ' ',\n      A: 'a',\n      S: 's',\n      D: 'd',\n    };\n\n    switch (e.key) {\n      case keys.spacebar:\n        ticker.toggle();\n        e.preventDefault(); // prevent scroll triggered by spacebar\n        break;\n      case keys.A:\n        ticker.skipBack();\n        break;\n      case keys.S:\n        ticker.toggle();\n        break;\n      case keys.D:\n        ticker.skipForward();\n        break;\n    }\n  }\n\n  function unregister() {\n    events.forEach((event) => {\n      event.element.removeEventListener(event.event, event.handler);\n    });\n  }\n\n  function addEventHandler(\n    root: HTMLElement,\n    className: string,\n    event: string,\n    handler: () => void,\n  ) {\n    const element = getElement(root, className);\n    if (element) {\n      element.addEventListener(event, handler);\n      events.push({\n        element,\n        event,\n        handler,\n      });\n    }\n  }\n}\n\nfunction dispatchDOMEvent(store: Store) {\n  const element = document.querySelector(store.getState().options.selector) as HTMLElement;\n  if (!element) return;\n\n  element.dispatchEvent(\n    new CustomEvent('racingBars/dateChange', {\n      bubbles: true,\n      detail: {\n        date: store.getState().ticker.currentDate,\n        isFirst: store.getState().ticker.isFirstDate,\n        isLast: store.getState().ticker.isLastDate,\n      },\n    } as DOMCustomEvent),\n  );\n}\n\nexport function DOMEventSubscriber(store: Store) {\n  let lastDate = '';\n  return function () {\n    const currentDate = store.getState().ticker.currentDate;\n    if (currentDate !== lastDate) {\n      dispatchDOMEvent(store);\n      lastDate = currentDate;\n    }\n  };\n}\n","import * as d3 from './d3';\nimport { prepareData, computeNextDateSubscriber } from './data-utils';\nimport { getDateString } from './dates';\nimport { Data, WideData } from './data';\nimport { createRenderer, rendererSubscriber, Renderer } from './renderer';\nimport { createTicker } from './ticker';\nimport { styleInject } from './styles';\nimport { actions, createStore, rootReducer, Store } from './store';\nimport { Options } from './options';\nimport { registerEvents, DOMEventSubscriber } from './events';\nimport { safeName } from './utils';\nimport { Race } from './models';\n\nexport function race(data: Data[] | WideData[], options: Partial<Options> = {}): Race {\n  if (!data || !Array.isArray(data) || data.length === 0) {\n    throw new Error('No valid data supplied.');\n  }\n\n  const store = createStore(rootReducer);\n  store.dispatch(actions.options.loadOptions(options));\n  const ticker = createTicker(store);\n  let preparedData = prepareData(data, store);\n  let renderer = createRenderer(preparedData, store);\n\n  const { selector, injectStyles, theme, autorun } = store.getState().options;\n\n  const root = document.querySelector(selector) as HTMLElement;\n  if (!root) throw new Error('No element found with the selector: ' + selector);\n\n  subscribeToStore(store, renderer, preparedData);\n\n  let stylesId: string;\n  if (injectStyles) {\n    stylesId = styleInject(selector, theme);\n  }\n\n  renderer.renderInitalView();\n  ticker.start();\n  if (!autorun) {\n    ticker.stop();\n  }\n\n  let events = registerEvents(store, ticker);\n  window.addEventListener('resize', resize);\n\n  function subscribeToStore(store: Store, renderer: Renderer, data: Data[]) {\n    store.subscribe(rendererSubscriber(store, renderer));\n    store.subscribe(computeNextDateSubscriber(data, store));\n    store.subscribe(DOMEventSubscriber(store));\n  }\n\n  function resize() {\n    renderer.resize();\n    events.unregister();\n    events = registerEvents(store, ticker);\n  }\n\n  function changeOptions(newOptions: Partial<Options>) {\n    const unAllowedOptions: Array<keyof Options> = ['selector', 'dataShape'];\n    unAllowedOptions.forEach((key) => {\n      if (newOptions[key] && newOptions[key] !== store.getState().options[key]) {\n        throw new Error(`The option \"${key}\" cannot be changed.`);\n      }\n    });\n\n    const dataOptions: Array<keyof Options> = [\n      'dataTransform',\n      'fillDateGapsInterval',\n      'fillDateGapsValue',\n      'startDate',\n      'endDate',\n      'fixedOrder',\n    ];\n    let dataOptionsChanged = false;\n    dataOptions.forEach((key) => {\n      if (newOptions[key] && newOptions[key] !== store.getState().options[key]) {\n        dataOptionsChanged = true;\n      }\n    });\n\n    store.dispatch(actions.options.changeOptions(newOptions));\n    const { injectStyles, theme, autorun } = store.getState().options;\n\n    if (dataOptionsChanged) {\n      store.unsubscribeAll();\n      store.dispatch(actions.data.clearDateSlices());\n      preparedData = prepareData(data as Data[], store, true);\n      renderer = createRenderer(preparedData, store);\n      subscribeToStore(store, renderer, preparedData);\n    }\n\n    if ('injectStyles' in newOptions || 'theme' in newOptions) {\n      document.getElementById(stylesId)?.remove();\n      if (injectStyles) {\n        stylesId = styleInject(selector, theme);\n      }\n    }\n\n    renderer.renderInitalView();\n    events.unregister();\n    events = registerEvents(store, ticker);\n\n    if (autorun) {\n      const { isFirstDate, isRunning } = store.getState().ticker;\n      if (isFirstDate && !isRunning) {\n        ticker.start();\n      }\n    }\n  }\n\n  function destroy() {\n    ticker.stop();\n    store.unsubscribeAll();\n    events.unregister();\n    window.removeEventListener('resize', resize);\n    root.innerHTML = '';\n    document.getElementById(stylesId)?.remove();\n    for (const method of Object.keys(API)) {\n      API[method as keyof Race] = () => {\n        throw new Error('Cannot perform this operation after calling destroy()');\n      };\n    }\n  }\n\n  const API = {\n    // TODO: validate user input\n    play: () => (!store.getState().ticker.isRunning ? ticker.start() : undefined),\n    pause: () => ticker.stop(),\n    toggle: () => ticker.toggle(),\n    skipBack: () => ticker.skipBack(),\n    skipForward: () => ticker.skipForward(),\n    inc: (value = 1) => store.dispatch(actions.ticker.inc(+value)),\n    dec: (value = 1) => store.dispatch(actions.ticker.dec(+value)),\n    getDate: () => store.getState().ticker.currentDate,\n    setDate: (inputDate: string | Date) =>\n      store.dispatch(actions.ticker.updateDate(getDateString(inputDate))),\n    getAllDates: () => [...store.getState().ticker.dates],\n    isRunning: () => store.getState().ticker.isRunning,\n    select: (name: string) => {\n      d3.select(root)\n        .select('rect.' + safeName(name))\n        .classed('selected', true);\n      store.dispatch(actions.data.addSelection(name));\n    },\n    unselect: (name: string) => {\n      d3.select(root)\n        .select('rect.' + safeName(name))\n        .classed('selected', false);\n      store.dispatch(actions.data.removeSelection(name));\n    },\n    unselectAll: () => {\n      d3.select(root).selectAll('rect').classed('selected', false);\n      store.dispatch(actions.data.resetSelections());\n    },\n    hideGroup: (group: string) => store.dispatch(actions.data.addFilter(String(group))),\n    showGroup: (group: string) => store.dispatch(actions.data.removeFilter(String(group))),\n    showOnlyGroup: (group: string) => store.dispatch(actions.data.allExceptFilter(String(group))),\n    showAllGroups: () => store.dispatch(actions.data.resetFilters()),\n    changeOptions,\n    destroy,\n  };\n\n  return API;\n}\n","import { loadData, Data, WideData, Options, defaultOptions, Race } from '..';\r\n\r\nexport function processProps(props: any, elementId: string) {\r\n  const selector = '#' + elementId;\r\n  const { data, dataUrl, dataType, callback, ...attr } = props;\r\n  const options: Partial<Options> = { ...attr, selector };\r\n\r\n  let dataPromise: Promise<Data[]> | Promise<WideData[]>;\r\n  if (dataUrl && !data) {\r\n    dataPromise = loadData(dataUrl, dataType);\r\n  } else if (isPromise(data)) {\r\n    dataPromise = data;\r\n  } else {\r\n    dataPromise = Promise.resolve(data);\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n  const cb = callback && typeof callback === 'function' ? callback : (_racer: Race) => {};\r\n\r\n  return {\r\n    dataPromise,\r\n    options,\r\n    callback: cb,\r\n  };\r\n}\r\n\r\nfunction isPromise(p: any) {\r\n  return Boolean(p && typeof p.then === 'function');\r\n}\r\n\r\n/**\r\n * Type for component props.\r\n * Extends [[Options]]\r\n * Defines props passed to components (angular/react/vue).\r\n * See [options documentations](/docs/documentation/options) for the rest of props.\r\n */\r\nexport class Props extends Options {\r\n  /** Data array */\r\n  public data!: Data[] | WideData[];\r\n\r\n  /** Url to fetch data from. This is ignored if [[Props.data]] is specified. */\r\n  public dataUrl!: string;\r\n\r\n  /** Type of data fetched from Url by [[Props.dataUrl]] */\r\n  public dataType!: 'json' | 'csv' | 'tsv' | 'xml';\r\n\r\n  /** An `id` to assign to the generated DOM element */\r\n  public elementId!: string;\r\n\r\n  /** Content to show till the chart loads. This can accept HTML. */\r\n  public loadingContent!: string;\r\n\r\n  /** Callback function that is executed after the chart loads.\r\n   *\r\n   * @param racer chart object ([[Race]]). Exposes the chart API.\r\n   * @param data data array. The data used by the chart before any transformation\r\n   */\r\n  public callback!: (racer: Race, data: Data[] | WideData[]) => void;\r\n}\r\n\r\nexport const defaultProps: Props = {\r\n  ...defaultOptions,\r\n  data: (undefined as unknown) as Data[],\r\n  dataUrl: (undefined as unknown) as string,\r\n  dataType: (undefined as unknown) as 'json',\r\n  elementId: (undefined as unknown) as string,\r\n  loadingContent: 'Loading...',\r\n  callback: (undefined as unknown) as () => {},\r\n};\r\n"],"names":["loadData","URL","type","d3","Error","actionTypes","loadOptions","changeOptions","options","payload","Options","getColor","d","store","getState","data","names","groups","showGroups","colorSeed","colorMap","color","useGroup","Boolean","group","length","values","shuffle","toNumber","currentValue","name","index","indexOf","Array","isArray","negativeIfOdd","lumVariation","random","HueSpacing","hue","getIconID","safeName","zeroPad","n","w","toString","s","String","nums","i","charCodeAt","InputSeed","seed","x","Math","sin","floor","arr","array","m","t","generateId","prefix","rnd","fill","map","substr","join","slice","getHeight","element","minHeight","height","newHeight","getBoundingClientRect","startsWith","scale","split","window","innerHeight","getWidth","minWidth","width","newWidth","innerWidth","getElement","root","className","querySelector","showElement","useVisibility","style","visibility","display","hideElement","getText","param","currentDate","dateSlice","dates","isDate","formatDate","replace","toggleClass","selector","select","classed","debounce","func","wait","immediate","timeout","_clicks","_Fn","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout","getClicks","event","Fn","pipe","reduce","f","g","getDates","from","Set","date","sort","getDateString","inputDate","Date","isNaN","year","getFullYear","month","getMonth","day","getDate","dateStr","format","weekDayIndex","getDay","monthNames","weekDays","getDateRange","date1","date2","interval","range","daysInMonth","sameDay","sameMonth","numberOfMonths","count","numberOfYears","outputRange","filter","round","getNextDate","currentIndex","lastIndex","defaultOptions","dataShape","dataTransform","fillDateGapsInterval","fillDateGapsValue","startDate","endDate","tickDuration","topN","mouseControls","keyboardControls","autorun","loop","injectStyles","title","subTitle","caption","dateCounter","labelsPosition","labelsWidth","showIcons","controlButtons","overlays","inputHeight","inputWidth","marginTop","marginRight","marginBottom","marginLeft","theme","fixedScale","fixedOrder","highlightBars","selectBars","optionsReducer","state","action","excludedKeys","Object","keys","forEach","key","includes","Number","dataLoaded","addFilter","removeFilter","toggleFilter","resetFilters","allExceptFilter","addSelection","removeSelection","toggleSelection","resetSelections","addDateSlice","clearDateSlices","dataCollections","selection","triggerRender","initialState","groupFilter","selected","dateSlices","dataReducer","addToArray","removeFromArray","toggleItem","item","push","initialize","changeDates","updateDate","setRunning","setFirst","setLast","inc","dec","running","value","isRunning","isFirstDate","isLastDate","tickerReducer","incValue","newDate","decValue","createTicker","ticker","start","justStarted","showRace","dispatch","actions","_","stop","skipBack","skipForward","toggle","goToDate","rootReducer","createStore","reducer","preloadedState","notifySubscribers","subscribers","subscribe","fn","unsubscribe","splice","unsubscribeAll","prepareData","changingOptions","customDataTransform","filterByDate","wideDataToLong","processFixedOrder","validateAndSort","fillDateGaps","calculateLastValues","storeDataCollections","transformFn","rank","a","b","localeCompare","fillGaps","acc","curr","lastValue","last","nested","long","row","entries","longDataToWide","wide","dateRow","r","details","fillValue","wideData","allData","lastDate","rangeStep","iData","interpolateTopN","newData","j","newRow","data1","data2","topData1","getTopN","topData2","topNames","filteredData1","obj","filteredData2","getDateSlice","getRank","emptyData","filterGroups","computeNextDateSubscriber","nextDate","calculateDimensions","renderOptions","maxValue","titlePadding","titleHeight","subTitleHeight","groupsHeight","controlsHeight","headerHeight","max","labelsArea","topAxisPadding","margin","top","right","bottom","left","domain","y","barPadding","labelPadding","barWidth","abs","barHeight","barHalfHeight","barY","iconSize","iconSpace","labelX","halo","text","svg","selectAll","remove","parentNode","insertBefore","cloneNode","legendClick","clicks","detail","highlightFn","selectFn","renderHeader","CompleteDateSlice","titleText","append","attr","html","subTitleText","legendsWrapper","legends","enter","on","legendX","legendY","each","wrapper","bbox","node","getBBox","elements","controls","play","pause","overlay","overlayPlay","overlayRepeat","buttons","renderControls","elementWidth","controlButtonIcons","updateControls","renderOverlays","overlayButtonIcons","renderInitalView","document","lastDateIndex","innerHTML","renderInitialFrame","val","xAxis","ticks","tickSize","tickFormat","call","defs","icon","endY","endX","dateCounterTextY","dateCounterText","captionText","renderFrame","transition","duration","ease","bars","exit","labels","valueLabels","sameDate","tween","textContent","iconPatterns","icons","resize","currentPosition","position","createRenderer","rendererSubscriber","renderer","styles","themes","styleInject","insertAt","css","head","getElementsByTagName","createElement","id","firstChild","appendChild","styleSheet","cssText","createTextNode","registerEvents","events","registerControlButtonEvents","registerOverlayEvents","registerClickEvents","registerKeyboardEvents","unregister","addEventHandler","addEventListener","clickEvent","target","classList","contains","handleKeyboardEvents","handler","e","activeElement","tagName","toLowerCase","spacebar","A","S","D","preventDefault","removeEventListener","dispatchDOMEvent","dispatchEvent","CustomEvent","bubbles","isFirst","isLast","DOMEventSubscriber","race","preparedData","subscribeToStore","stylesId","newOptions","unAllowedOptions","dataOptions","dataOptionsChanged","getElementById","destroy","API","method","undefined","setDate","getAllDates","unselect","unselectAll","hideGroup","showGroup","showOnlyGroup","showAllGroups","Props","defaultProps","dataUrl","dataType","elementId","loadingContent","callback"],"mappings":"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"}